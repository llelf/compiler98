<html><head><title>Building/installing nhc98</title></head>
<body bgcolor=#ffffff>
<table><tr><td width=500>

<center><h1>Building/installing nhc98</h1></center>

<hr>
<h3>The Brief Version</h3>
<p>
If you are in a hurry to get started, here's the brief version of the
install procedure:
<pre>
    $ ./configure  [ --prefix=/usr/local ]
    $ make [ all ]
    [ perhaps become root ]
    $ make install
</pre>

<h3>System Requirements</h3>
<p>
Users of Windows 95/98/SE/Me/NT/2k/XP, please see these
<a href="windows.html">special Windows instructions</a> first.

<p>
If you want to use the trace browsing tools <tt>hat-trail</tt> or
<tt>hood</tt>, you will need to have Java on your PATH.  Java 1.2
and 1.3 work okay, but at least for <tt>hat-trail</tt> they may not
produce as pretty displays as Java 1.1 (we recommend jdk-1.1.7).

<p>
For the binary release, we assume you have a good C compiler (usually
<em>gcc</em>), and a <em>sh</em> compatible with the Bourne shell.

<p>
For the source release, you need the usual C compilation management
tools (<em>gcc</em>, <em>ar</em>, GNU <em>make</em>, etc.).  To build
<b>nhc98</b> without another Haskell compiler, you need 8Mb of memory
(although you could probably manage with less), and about 27Mb of disk
space (50Mb if you build for profiling and tracing as well).  If you
already have another Haskell compiler, <em>hbc</em> or <em>ghc</em>,
then building <b>nhc98</b> will require at least 32Mb of memory,
and 70Mb of free disk space.  If you don't have <em>hbc</em> or
<em>ghc</em> for your machine, then don't worry, <b>nhc98</b> will
build quite happily using just a C compiler.  (The basic build is
much faster, but the resulting compiler will be slower.)  You can
also build <em>nhc98</em> using an earlier version of <em>nhc98</em>
if you want, but we don't do that by default because the build time
can be slow.

<h3>Download it</h3>
<p>
You have the option of building <b>nhc98</b> from a source tree, or
installing a binary-only distribution.  You only need to collect the
single package you require.

<p>
The current distribution packages can be found at
<pre>
    <a href="http://www.cs.york.ac.uk/fp/nhc98/download.html">http://www.cs.york.ac.uk/fp/nhc98/download.html</a>
</pre>
Using <em>tar</em> and <em>gunzip</em>, unpack your chosen package, and
<em>cd</em> to the base directory (called nhc98-x.x, where the x's are the
version number).  Note that all the documentation available on the web
is also included in all packages, although the web versions will of course
be more up-to-date.  Your local copy of the release notes is
in <a href="status.html">docs/status.html</a>.

<h3>Configuration</h3>
<p>
An automatic configuration utility is supplied, called
<em>configure</em>.  In brief, the default behaviour is to build under
<tt>targets</tt> in the current directory, and to install various
components under <tt>/usr/local</tt>, in the subdirectories
<tt>bin</tt>, <tt>lib/nhc98</tt>, <tt>include/nhc98</tt>, and
<tt>man/man1</tt>.  The config script has several useful options to
override the default build and installation behaviours.  Use the
<tt>--help</tt> option for brief details, and see the page about
<a href=config.html>configuration options</a> for full details.

<p>
<b>Important:</b> The config script searches your system for other
Haskell compilers.  If it guesses wrongly, you can edit the file
<tt>script/hmake.config</tt> to fix things up, then re-run
<em>configure</em>.  Your changes will not be undone.

<h3>Installing from a binary distribution</h3>
<p>
Simply run
<pre>
    ./configure
    make install
</pre>
to install <b>nhc98</b>.  The default location is under
<tt>/usr/local</tt>, but you may alter the installation location using
either of the <tt>--prefix=</tt> or <tt>--installdir=</tt> options
to <em>configure</em>.  There are various other
<a href=config.html>configuration options</a> also.



<h3>Building and installing from sources</h3>
<p>
All object files are created in a separate directory tree from the
sources.  This means it is possible to build concurrently for different
machines from the same shared source tree.  You can also build the heap
profiling, time profiling, and tracing versions of the prelude and
runtime system concurrently if you wish.

<p>
The current distribution of the compiler will build for any machine with
32-bit words.  All questions of machine endian-ness are handled
automatically during configuration.  If you are not using <em>gcc</em>
as your C compiler, please ensure that your <tt>CC</tt> environment
variable is set appropriately at the configuration stage.  (The C
compiler is used as a portable backend for nhc98, and is always
required.)

<p>
Run <tt>./configure</tt> with any <a href=config.html>options</a> you
require.  (You should supply installation directory options at this
stage.)  This will attempt to detect any existing Haskell compilers and
guess which one to build <em>nhc98</em> with.  If you have more than one
available, we will choose, in order of preference, <em>ghc</em>, then
<em>hbc</em>.  If neither of these is found, <em>nhc98</em> will be
built from the bootstrapping C sources included in the package.  (You
can build <em>nhc98</em> using an earlier version of <em>nhc98</em> if
you want using the configure options, but it is not selected by default.)

<p>
Decide what profiling and tracing features you want to use -
<tt>make help</tt> gives a list of useful individual targets,
such as <tt>basic</tt>, <tt>heapprofile</tt>, <tt>timeprofile</tt>
and <tt>tracer</tt>.

<p>
Then run <tt>make</tt> with your chosen targets, or <tt>make all</tt>
to build all the possible facilities.  (A simple <tt>make</tt>
without targets builds only the basic compiler and tools, with no
support for tracing or profiling.)

<p>
The time taken to build nhc98 depends on your machine, which compiler
you are using, and whether you have asked for just the basic system or
some extra components.  Here are some sample build times in minutes,
all on Pentium class machines:

<center>
<table><tr>
    <th></th>
    <th colspan=3>500Mhz/Linux</th>
    <th colspan=2>150MHz/Linux</th>
    <th colspan=2>150MHz/Win95</th>
</tr><tr>
    <th>build compiler</th>
    <th>basic</th><th>basic+tracer</th><th>all</th>
    <th>basic</th><th>all</th>
    <th>basic</th><th>all</th>
</tr><tr>
    <td>gcc</td><td>5</td><td>xxx</td><td>262</td><td>14</td><td>450</td><td>45</td><td>1200</td>
</tr><tr>
    <td>ghc</td><td>21</td><td>xxx</td><td>69</td><td>99</td><td></td><td></td><td></td>
</tr><tr>
    <td>hbc</td><td>22</td><td>xxx</td><td>110</td><td></td><td></td><td></td><td></td>
</tr><tr>
    <td>nhc98</td><td>50</td><td>xxx</td><td>288</td><td></td><td></td><td></td><td></td>
</tr></table>
</center>

<p>
Finally, when you have built all the components you require, type
<tt>make install</tt> to copy the components to their final location.
(You may need to become root for this step, depending on the final
location you selected at configure time.)  As an alternative to
installing in a system-wide location, it is also possible to use
all the <b>nhc98</b> tools in-place in the build tree by adding the
<tt>script</tt> directory to your PATH (if you wish to keep your
disk usage down, use <tt>make clean</tt> or <tt>make realclean</tt>)



<h3>Problems?</h3>
<p>
Ok, so now you should have all the components of a working compiler.
If you have any problems, mail <a href="mailto:nhc-bugs@haskell.org">
<tt>nhc-bugs@haskell.org</tt></a> with a description (and a
bugfix if you have one!).

<h3>Can you help us?</h3>
<p>
If you have built <b>nhc98</b> for a machine not currently listed on the
<a href=download.html>download page</a> and would like to contribute
it as a binary package for others to download, it is very easy to do.
After building and installing, type `<tt>make binDist</tt>' <em>before</em>
you tidy up with `<tt>make clean</tt>'.  Then upload the resulting tarfile
by ftp to
<pre>
    ftp://ftp.cs.york.ac.uk/pub/haskell/incoming/
</pre>
and send an email to let us know it's there.

<h3>Keeping up-to-date</h3>
<p>
If you use <b>nhc98</b> regularly, please join the <a href="maillist.html">
nhc-users</a> mailing list for discussion of features, bugfixes, and so on.

<hr>
<p>
The latest updates to these pages are available on the WWW from
<a href="http://www.cs.york.ac.uk/fp/nhc98/">
<tt>http://www.cs.york.ac.uk/fp/nhc98/</tt></a>

<p>
This page last modified: 2001.05.18<br>
<a href="http://www.cs.york.ac.uk/fp/">
York Functional Programming Group</a><br>

</td></tr></table>
</body></html>

